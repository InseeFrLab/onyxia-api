{
  "packages": [
    {
      "packagingVersion": "3.0",
      "name": "shelly",
      "version": "1.0.0",
      "minDcosReleaseVersion": "1.8",
      "scm": "https://github.com/InseeFrLab/Shelly",
      "maintainer": "https://github.com/InseeFrLab",
      "website": "https://github.com/InseeFrLab",
      "framework": false,
      "description": "Shelly is the cloud shell availabe inside the datalab. It can manage all the API and services",
      "tags": ["shell", "onyxia"],
      "preInstallNotes": "This service is currently in preview.",
      "postInstallNotes": "Shelly has been installed.",
      "postUninstallNotes": "Shelly has been uninstalled.",
      "licenses": [
        { "name": "GPLv2", "url": "https://wordpress.org/about/license/" }
      ],
      "selected": false,
      "lastUpdated": 1491426142,
      "releaseVersion": 1,
      "resource": {
        "images": {
          "icon-small": "https://portail.lab.sspcloud.fr/onyxia.svg",
          "icon-medium": "https://portail.lab.sspcloud.fr/onyxia.svg",
          "icon-large": "https://portail.lab.sspcloud.fr/onyxia.svg"
        },
        "assets": {
          "container": {
            "docker": { "shelly": "inseefrlab/shelly:cloudshell" }
          }
        }
      },
      "marathon": {
        "v2AppMustacheTemplate": "ewogICAgImlkIjogInt7c2VydmljZS5uYW1lfX0iLAogICAgImNwdXMiOiAwLjEsCiAgICAibWVtIjogNDA5NiwKICAgICJpbnN0YW5jZXMiOiAxLAogICAgImNtZCI6ICJiYXNoIC9tbnQvbWVzb3Mvc2FuZGJveC9vbnl4aWEtaW5pdC5zaCAmJiAvdXNyL3NiaW4vc3NoZCA7IC91c3IvYmluL25vZGUgL3Jvb3Qvd2Vic3NoMi9hcHAvaW5kZXguanMiLAogICAgImNvbnRhaW5lciI6IHsKICAgICAgICAgInR5cGUiOiAiRE9DS0VSIiwKICAgICAgICAgImRvY2tlciI6IHsKICAgICAgICAgICAgICJpbWFnZSI6ICJ7e3Jlc291cmNlLmFzc2V0cy5jb250YWluZXIuZG9ja2VyLnNoZWxseX19IiwKICAgICAgICAgICAgICJuZXR3b3JrIjogIkJSSURHRSIsCiAgICAgICAgICAgICAicG9ydE1hcHBpbmdzIjogWwogICAgICAgICAgICAgICAgeyAiY29udGFpbmVyUG9ydCI6IDIyMjIsICJob3N0UG9ydCI6IDAgfQogICAgICAgICAgICBdCiAgICAgICAgIH0KICAgICB9LAogICAgICJoZWFsdGhDaGVja3MiOiBbCiAgICAgIHsKICAgICAgICAicG9ydEluZGV4IjogMCwKICAgICAgICAicHJvdG9jb2wiOiAiTUVTT1NfVENQIiwKICAgICAgICAiZ3JhY2VQZXJpb2RTZWNvbmRzIjogMzAsCiAgICAgICAgImludGVydmFsU2Vjb25kcyI6IDYwLAogICAgICAgICJ0aW1lb3V0U2Vjb25kcyI6IDIwLAogICAgICAgICJtYXhDb25zZWN1dGl2ZUZhaWx1cmVzIjogMwogICAgICB9CiAgICBdLAogICAgImxhYmVscyI6IHsKICAgICAgIkhBUFJPWFlfR1JPVVAiOiJleHRlcm5hbCIsCiAgICAgICJIQVBST1hZXzBfVkhPU1QiOiJ7e25ldHdvcmtpbmcudmlydHVhbC1ob3N0fX0iLAogICAgICAiSEFQUk9YWV8wX0VOQUJMRUQiOiAidHJ1ZSIsCiAgICAgICJIQVBST1hZXzBfUkVESVJFQ1RfVE9fSFRUUFMiOiAie3tuZXR3b3JraW5nLmh0dHBzLXJlZGlyZWN0fX0iLAogICAgICAiTUFSQVRIT05fU0lOR0xFX0lOU1RBTkNFX0FQUCI6ICJ0cnVlIgogICAgfSwKICAgICJlbnYiOiB7CiAgICAgICAgIkFXU19BQ0NFU1NfS0VZX0lEIjogInt7czMuYWNjZXNzS2V5SWR9fSIsCiAgICAgICAgIkFXU19TRUNSRVRfQUNDRVNTX0tFWSI6ICJ7e3MzLnNlY3JldEFjY2Vzc0tleX19IiwKICAgICAgICAiQVdTX1NFU1NJT05fVE9LRU4iOiAie3tzMy5zZXNzaW9uVG9rZW59fSIsCiAgICAgICAgIkFXU19ERUZBVUxUX1JFR0lPTiI6ICJ7e3MzLmRlZmF1bHRSZWdpb259fSIsCiAgICAgICAgIkFXU19TM19FTkRQT0lOVCI6ICJ7e3MzLmVuZHBvaW50fX0iLAogICAgICAgICJBV1NfRVhQSVJBVElPTiI6ICJ7e3MzLmV4cGlyYXRpb259fSIsCiAgICAgICAgIkdJVF9VU0VSX05BTUUiOiAie3tnaXQubmFtZX19IiwKICAgICAgICAiR0lUX1VTRVJfTUFJTCI6ICJ7e2dpdC5lbWFpbH19IiwKICAgICAgICAiR0lUX0NSRURFTlRJQUxTX0NBQ0hFX0RVUkFUSU9OIjogInt7Z2l0LmNhY2hlfX0iICAgIAogICAgfSwKICAgICJ1cGdyYWRlU3RyYXRlZ3kiOnsKICAgICAgIm1pbmltdW1IZWFsdGhDYXBhY2l0eSI6IDAsCiAgICAgICJtYXhpbXVtT3ZlckNhcGFjaXR5IjogMAogICAgfQp9Cg=="
      },
      "config": {
        "type": "object",
        "properties": {
          "service": {
            "description": "Configuration properties for the shelly service.",
            "type": "object",
            "properties": {
              "name": {
                "description": "The name of the service to display in the DC/OS dashboard.",
                "type": "string",
                "default": "shelly",
                "x-form": {
                  "hidden": true
                },
                "x-generated": {
                  "type": "appID",
                  "scope": "shelly"
                }
              },
              "cpus": {
                "description": "CPU shares to allocate to this shelly instance.",
                "type": "number",
                "default": 0.1,
                "minimum": 0.1
              },
              "mem": {
                "description": "Memory (in MB) to allocate to this shelly instance.",
                "type": "number",
                "default": 1024.0,
                "minimum": 256.0
              }
            },
            "required": ["name", "cpus", "mem"]
          },
          "git": {
            "description": "Git user configuration",
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "user name for git",
                "default": "",
                "x-form": {
                  "value": "{{git.name}}",
                  "readonly": true
                }
              },
              "email": {
                "type": "string",
                "description": "user email for git",
                "default": "",
                "x-form": {
                  "value": "{{git.email}}",
                  "readonly": true
                }
              },
              "cache": {
                "type": "string",
                "description": "duration in seconds of the credentials cache duration",
                "default": "",
                "x-form": {
                  "value": "{{git.credentials_cache_duration}}",
                  "readonly": false
                }
              }
            }
          },
          "s3": {
            "description": "Configuration of temporary identity",
            "type": "object",
            "properties": {
              "accessKeyId": {
                "description": "AWS Access Key",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_ACCESS_KEY_ID}}"
                }
              },
              "endpoint": {
                "description": "AWS S3 Endpoint",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_S3_ENDPOINT}}"
                }
              },
              "defaultRegion": {
                "description": "AWS S3 default region",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_DEFAULT_REGION}}"
                }
              },
              "secretAccessKey": {
                "description": "AWS S3 secret access key",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_SECRET_ACCESS_KEY}}"
                }
              },
              "sessionToken": {
                "description": "AWS S3 session Token",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_SESSION_TOKEN}}"
                }
              },
              "expiration": {
                "description": "Temporary identity expiration date",
                "type": "string",
                "x-form": {
                  "value": "{{s3.AWS_EXPIRATION}}"
                }
              }
            }
        },
          "networking": {
            "description": "Networking-related configuration properties for Shelly.",
            "type": "object",
            "properties": {
              "virtual-host": {
                "description": "The virtual host address to configure for integration with Marathon-lb.",
                "type": "string",
                "default": "changeme",
                "x-form": {
                    "hidden": true
                },
                "x-generated": {
                  "type": "externalDNS",
                  "scope": "shelly",
                  "name": "webssh"
                }
              },
              "https-redirect": {
                "description": "Whether Marathon-lb should redirect HTTP traffic to HTTPS. This requires 'virtual-host' to be set. By default, this is false.",
                "type": "boolean",
                "default": false
              }
            }
          }
        },
        "required": ["service", "networking"]
      }
    }
  ]
}
